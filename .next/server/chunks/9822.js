"use strict";exports.id=9822,exports.ids=[9822],exports.modules={89822:(e,t,a)=>{a.r(t),a.d(t,{fetchUser:()=>s,fetchUserPosts:()=>l,fetchUsers:()=>u,getActivity:()=>f,updateUser:()=>o});var r=a(10459),c=a(50561),i=a(98024),n=a(78291),d=a(9148);async function o({userId:e,username:t,name:a,bio:r,image:d,path:o}){(0,n.P)();try{await i.Z.findOneAndUpdate({id:e},{username:t.toLowerCase(),name:a,bio:r,image:d,onboarded:!0},{upsert:!0}),"/profile/edit"===o&&(0,c.revalidatePath)(o)}catch(e){throw Error(`Failed to create/update user: ${e.message}`)}}async function s(e){try{return(0,n.P)(),await i.Z.findOne({id:e})}catch(e){throw Error(`Failed to fetch user: ${e.message}`)}}async function l(e){try{(0,n.P)();let t=await i.Z.findOne({id:e}).populate({path:"threads",model:d.Z,populate:{path:"children",model:d.Z,populate:{path:"author",model:i.Z,select:"name image id"}}});return t}catch(e){throw Error(`Error fetching all user posts ${e.message}`)}}async function u({userId:e,searchString:t="",pageNumber:a=1,pageSize:r=20,sortBy:c="desc"}){try{(0,n.P)();let d=(a-1)*r,o=RegExp(t,"i"),s={id:{$ne:e}};""!==t.trim()&&(s.$or=[{username:{$regex:o}},{name:{$regex:o}}]);let l=i.Z.find(s).sort({createdAt:c}).skip(d).limit(r),u=await i.Z.countDocuments(s),f=await l.exec(),h=u>d+f.length;return{users:f,isNext:h}}catch(e){throw Error(`Failed to fetch all users: ${e.message}`)}}async function f(e){try{(0,n.P)();let t=await d.Z.find({author:e}),a=t.reduce((e,t)=>e.concat(t.children),[]),r=await d.Z.find({_id:{$in:a},author:{$ne:e}}).populate({path:"author",model:i.Z,select:"name image _id"});return r}catch(e){throw Error(`Failed to get activity: ${e.message}`)}}(0,a(51419).h)([o,s,l,u,f]),(0,r.U)("ff1d10e4c4589040540250355c302d70862062e6",null,o),(0,r.U)("1596b48302c0ee3dbe71040264d262724aaf5922",null,s),(0,r.U)("4136361b190c15107930ce3a82a69c155f3f5e21",null,l),(0,r.U)("a1a227a67ee82139c2a8df61f007c4e13a42bd7d",null,u),(0,r.U)("8ec1f8a9f390f17362a26d8913fa4e2dfef86fce",null,f)}};