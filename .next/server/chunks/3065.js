exports.id=3065,exports.ids=[3065],exports.modules={73065:(e,a,d)=>{let t={ff1d10e4c4589040540250355c302d70862062e6:()=>Promise.resolve().then(d.bind(d,89822)).then(e=>e.updateUser),"1596b48302c0ee3dbe71040264d262724aaf5922":()=>Promise.resolve().then(d.bind(d,89822)).then(e=>e.fetchUser),"4136361b190c15107930ce3a82a69c155f3f5e21":()=>Promise.resolve().then(d.bind(d,89822)).then(e=>e.fetchUserPosts),a1a227a67ee82139c2a8df61f007c4e13a42bd7d:()=>Promise.resolve().then(d.bind(d,89822)).then(e=>e.fetchUsers),"8ec1f8a9f390f17362a26d8913fa4e2dfef86fce":()=>Promise.resolve().then(d.bind(d,89822)).then(e=>e.getActivity),"38d2d7a0a35de985e321f749280c69191b8c2814":()=>Promise.resolve().then(d.bind(d,87285)).then(e=>e.fetchPosts),"78e111e9dc41efac987bd5e8ac51b19043c9068a":()=>Promise.resolve().then(d.bind(d,87285)).then(e=>e.createThread),b5742e553fecb2b810f82b514ddc398a21ae6ac0:()=>Promise.resolve().then(d.bind(d,87285)).then(e=>e.deleteThread),"39784508112122b2d6fe16b8d277c4cb71a3d20d":()=>Promise.resolve().then(d.bind(d,87285)).then(e=>e.fetchThreadById),e5fb2a651b5b7a205c654d5be1a786f5e317b9d1:()=>Promise.resolve().then(d.bind(d,87285)).then(e=>e.addCommentToThread)};async function n(e,...a){let d=await t[e]();return d.apply(null,a)}e.exports={ff1d10e4c4589040540250355c302d70862062e6:n.bind(null,"ff1d10e4c4589040540250355c302d70862062e6"),"1596b48302c0ee3dbe71040264d262724aaf5922":n.bind(null,"1596b48302c0ee3dbe71040264d262724aaf5922"),"4136361b190c15107930ce3a82a69c155f3f5e21":n.bind(null,"4136361b190c15107930ce3a82a69c155f3f5e21"),a1a227a67ee82139c2a8df61f007c4e13a42bd7d:n.bind(null,"a1a227a67ee82139c2a8df61f007c4e13a42bd7d"),"8ec1f8a9f390f17362a26d8913fa4e2dfef86fce":n.bind(null,"8ec1f8a9f390f17362a26d8913fa4e2dfef86fce"),"38d2d7a0a35de985e321f749280c69191b8c2814":n.bind(null,"38d2d7a0a35de985e321f749280c69191b8c2814"),"78e111e9dc41efac987bd5e8ac51b19043c9068a":n.bind(null,"78e111e9dc41efac987bd5e8ac51b19043c9068a"),b5742e553fecb2b810f82b514ddc398a21ae6ac0:n.bind(null,"b5742e553fecb2b810f82b514ddc398a21ae6ac0"),"39784508112122b2d6fe16b8d277c4cb71a3d20d":n.bind(null,"39784508112122b2d6fe16b8d277c4cb71a3d20d"),e5fb2a651b5b7a205c654d5be1a786f5e317b9d1:n.bind(null,"e5fb2a651b5b7a205c654d5be1a786f5e317b9d1")}},87285:(e,a,d)=>{"use strict";d.r(a),d.d(a,{addCommentToThread:()=>u,createThread:()=>f,deleteThread:()=>h,fetchPosts:()=>l,fetchThreadById:()=>s});var t=d(10459),n=d(50561),r=d(78291),i=d(98024),c=d(9148),o=d(41035);async function l(e=1,a=20){(0,r.P)();let d=(e-1)*a,t=c.Z.find({parentId:{$in:[null,void 0]}}).sort({createdAt:"desc"}).skip(d).limit(a).populate({path:"author",model:i.Z}).populate({path:"community",model:o.Z}).populate({path:"children",populate:{path:"author",model:i.Z,select:"_id name parentId image"}}),n=await c.Z.countDocuments({parentId:{$in:[null,void 0]}}),l=await t.exec(),f=n>d+l.length;return{posts:l,isNext:f}}async function f({text:e,author:a,communityId:d,path:t}){try{(0,r.P)();let l=await o.Z.findOne({id:d},{_id:1}),f=await c.Z.create({text:e,author:a,community:l});await i.Z.findByIdAndUpdate(a,{$push:{threads:f._id}}),l&&await o.Z.findByIdAndUpdate(l,{$push:{threads:f._id}}),(0,n.revalidatePath)(t)}catch(e){throw Error(`Failed to create thread: ${e.message}`)}}async function b(e){let a=await c.Z.find({parentId:e}),d=[];for(let e of a){let a=await b(e._id);d.push(e,...a)}return d}async function h(e,a){try{(0,r.P)();let d=await c.Z.findById(e).populate("author community");if(!d)throw Error("Thread not found");let t=await b(e),l=[e,...t.map(e=>e._id)],f=new Set([...t.map(e=>e.author?._id?.toString()),d.author?._id?.toString()].filter(e=>void 0!==e)),h=new Set([...t.map(e=>e.community?._id?.toString()),d.community?._id?.toString()].filter(e=>void 0!==e));await c.Z.deleteMany({_id:{$in:l}}),await i.Z.updateMany({_id:{$in:Array.from(f)}},{$pull:{threads:{$in:l}}}),await o.Z.updateMany({_id:{$in:Array.from(h)}},{$pull:{threads:{$in:l}}}),(0,n.revalidatePath)(a)}catch(e){throw Error(`Failed to delete thread: ${e.message}`)}}async function s(e){(0,r.P)();try{let a=await c.Z.findById(e).populate({path:"author",model:i.Z,select:"_id id name image"}).populate({path:"community",model:o.Z,select:"_id id name image"}).populate({path:"children",populate:[{path:"author",model:i.Z,select:"_id id name parentId image"},{path:"children",model:c.Z,populate:{path:"author",model:i.Z,select:"_id id name parentId image"}}]}).exec();return a}catch(e){throw console.error("Error while fetching thread:",e),Error("Unable to fetch thread")}}async function u(e,a,d,t){(0,r.P)();try{let r=await c.Z.findById(e);if(!r)throw Error("Thread not found");let i=new c.Z({text:a,author:d,parentId:e}),o=await i.save();r.children.push(o._id),await r.save(),(0,n.revalidatePath)(t)}catch(e){throw console.error("Error while adding comment:",e),Error("Unable to add comment")}}(0,d(51419).h)([l,f,h,s,u]),(0,t.U)("38d2d7a0a35de985e321f749280c69191b8c2814",null,l),(0,t.U)("78e111e9dc41efac987bd5e8ac51b19043c9068a",null,f),(0,t.U)("b5742e553fecb2b810f82b514ddc398a21ae6ac0",null,h),(0,t.U)("39784508112122b2d6fe16b8d277c4cb71a3d20d",null,s),(0,t.U)("e5fb2a651b5b7a205c654d5be1a786f5e317b9d1",null,u)},41035:(e,a,d)=>{"use strict";d.d(a,{Z:()=>c});var t=d(11185),n=d.n(t);let r=new(n()).Schema({id:{type:String,required:!0},username:{type:String,unique:!0,required:!0},name:{type:String,required:!0},image:String,bio:String,createdBy:{type:n().Schema.Types.ObjectId,ref:"User"},threads:[{type:n().Schema.Types.ObjectId,ref:"Thread"}],members:[{type:n().Schema.Types.ObjectId,ref:"User"}]}),i=n().models.Community||n().model("Community",r),c=i}};